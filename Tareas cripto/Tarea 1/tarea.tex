\documentclass{article}
\usepackage{amsmath}
\usepackage{amssymb}
\newcommand{\enc}[2]{\text{Enc}_{#1}(#2)}
\begin{document}
  
  \section{Punto 1)}
    Demuestre o refute la siguiente afirmación:


    Para todo esquema perfectamente secreto, para toda distribución sobre el espacio de mensajes $M$,
    para todo par $m, m'\in M$ y para todo $c \in C$ (con $P[C = c] > 0$), se cumple que 
    \[P[M =m| C = c] = P[M = m'| C = c]\]


    Consideremos el conjunto de mensajes $M = \{A, B\}$, el conjunto de llaves $K = \{0, 1\}$ y 
    el conjunto de cifrados $C = \{D, E\}$, con $P[K = 0] = P[K = 1] = \frac{1}{2}$ y 
      \[P[M = A] = \frac{2}{5} \quad \quad P[M = B] = \frac{3}{5}\]
    
    Consideremos la función de encriptado Enc:
      \begin{equation*}
        \begin{aligned}
          \enc{0}{A} = D \quad\quad \enc{1}{A} = E \\
          \enc{0}{B} = E \quad\quad \enc{1}{B} = D
        \end{aligned}
     \end{equation*}


    entonces $C$ se distribuye de la siguiente manera:

    \begin{equation*}
      \begin{aligned}
        P[C = D] &= P[C = D | M = A] P[M = A] + P[C = D| M =B]P[M = B] \\
                 &= P[K = 0] P[M = A] + P[K = 1] P[M = B] \\
                 &= \frac{1}{2} \cdot \frac{2}{5} + \frac{1}{2}\cdot \frac{3}{5}
                 = \frac{1}{2}\\
        P[C = E] &= P[C = E| M = A] P[M = A] + P[C = E | M = B] P[M = B] \\
                 &= P[K = 1] P[M = A] + P[K = 0] P[M = B] \\
                 &= \frac{1}{2} \cdot \frac{2}{5} + \frac{1}{2}\cdot \frac{3}{5} 
                 = \frac{1}{2}
      \end{aligned}
    \end{equation*}

    Veamos que este sistema es seguro, comprobando que $P[\enc{K}{A} = c] = P[\enc{K}{B} = c]$, para $c \in C$,
    lo haremos recordando que $P[\enc{K}{m} = c] = P[C = c| M = m]$.

    \begin{equation*}
      \begin{aligned}
        P[\enc{K}{A} = E] = P[C = E| M = A] = P[K = 1] = \frac{1}{2} \\
        P[\enc{K}{A} = D] = P[C = D| M = A] = P[K = 0] = \frac{1}{2} \\
        P[\enc{K}{B} = E] = P[C = E| M = B] = P[K = 0] = \frac{1}{2} \\
        P[\enc{K}{B} = D] = P[C = D| M = B] = P[K = 1] = \frac{1}{2}
      \end{aligned}
    \end{equation*}

    De esto último se concluye que es un sistema seguro.

    Ahora verifiquemos $P[M = B | C=E]$ y $P[M = A| C=E]$:

    \begin{equation*}
      \begin{aligned}
        P[M = B| C=E] &= P[C = E| M=B] \frac{P[M=B]}{P[C=E]} \\
                      &= \frac{1}{2} \frac{\frac{3}{5}}{\frac{1}{2}}= \frac{3}{5}\\
        P[M = A| C=E] &= P[C = E| M=A] \frac{P[M=A]}{P[C=E]} \\
                      &= \frac{1}{2} \frac{\frac{2}{5}}{\frac{1}{2}}= \frac{2}{5}
      \end{aligned}
    \end{equation*}

    De ahí se concluye que $P[\enc{K}{A} = c] \neq P[\enc{K}{B} = c]$.
  
  \section{Punto 2)}
    Considere los siguientes cifrados sobre un alfabeto finito $\Sigma$:

    \begin{itemize}
      \item Cifrado por desplazamiento.
      \item Cifrado por sustitución.
      \item Cifrado Vigenère.
    \end{itemize}

    a) Describa un ataque de texto en claro elegido que recupere la clave de cada uno de los tres cifrado.

    b) Cuantifique cuánto texto en claro elegido se necesita para recuperar la clave en cada caso.

    \subsection{Cifrado por desplazamiento}
      Elejimos el primer caracter del alfabeto porque inmediatamente se conoce la clave ya que el desplazamiento
      es fijo para todos los caracteres, a continuación se describe a detalle.


      Consideremos un cifrado con desplazamiento sobre un alfabeto finito $\Sigma = \{\sigma_1, \cdots, \sigma_n\}$,
      seleccionamos la palabra $\sigma_1$ y al aplicar la encriptación obtenemos un $\sigma_l$, la clave corresponde 
      al único natural $k$ tal que $1 + k = l$.
    \subsection{Cifrado por sustitución}
      Ahora vamos a elejir una palabra especial para conocer la permutación usada y es que si conocemos 
      a dónde se permuta cada caracter entonces conocemos la clave, es decir, vamos a usar solo una palabra,
      a continuación se describe a detalle el procedimiento.


      Sea $\Sigma = \{\sigma_1, \cdots, \sigma_n\}$ un alfabeto y consideremos un cifrado por sustitución en este 
      alfabeto. Tomemos la palabra $\sigma_1\sigma_2\cdots\sigma_n$, es decir, cocatenamos todos 
      los caracteres del alfabeto. Al recibir el mensaje encriptado, recibimos una palabra $\sigma_{i_1}\sigma_{i_2}\cdots\sigma_{i_n}$,
      de donde se deduce inmediatamente que la permutación corresponde a 

      \begin{equation*}
        \begin{aligned}
          \sigma: \Sigma &\to \Sigma \\
          \sigma_j &\to \sigma_{i_j}
        \end{aligned}
      \end{equation*}

    \subsection{Cifrado de Vigenère}
      La idea para este tipo de cifrado es bastante algoritmica, y es que vamos a fijar un caracter 
      del alfabeto y concatemos ese caracter $n-veces$ hasta que en el texto devuelto por el oraculo, 
      apararezca una palabra duplicada, es decir, si el tamaño de la clave es $k$, el proceso se 
      ejecutará $2k$ veces.


      Sea $\Sigma =\{\sigma_1, \cdots, \sigma_n\}$ un alfabeto y consideremos el cifrado de Vigenère. 
      A continuación describimos el algoritmo en el siguiente conjunto de pasos.

      \begin{itemize}
        \item Paso 1) Tomamos la palabra anterior $\sigma_1 ^p := \sigma_1\cdots \sigma_{1}$ y lo mandamos cifrar y obtenemos $\sigma_{i_1}\cdots\sigma_{i_p}$.
        \item Paso 2) Si el cifrado obteniedo en el paso anterior es la concatenación de dos palabras, es decir,
              $\sigma_1\cdots\sigma_p = t\cdot t$ para alguna palabra $t$ hacemos el paso 3, y si no, repetimos 
              el paso 1.

            \item Paso 3) Una vez tenemos la palabra $t := \sigma_{j_1}\cdots\sigma_{j_{p/2}}$, 
      \end{itemize}
      
  \section{Punto 3)}
    Sean $f, g: \mathbb{N} \to \mathbb{R}_{\ge 0}$ dos funciones negligibles tales que $f(n) \ge g(n)$ para todo $n \in \mathbb{N}$.
    Para cada una de las definiciones de $f'(n)$ determine si necesariamente $f'$ es negligible bajo las 
    hipótesis dadas. En cada caso, pruebe su afirmación o proporcione un contraejemplo que respeste las 
    condiciones sobre $f$ y $g$.

    \subsection{Punto a)}
      \[f'(n) := \frac{1}{2^{\log^2 n}}\]

      Sea $c \in \mathbb{N}$ y $n > N$ donde $N$ es el menor natural tal que $\log N > c$ y como 
      el $\log$ es una función creciente, entonces 
      \[\log n > c\]
      Entonces se cumplen las siguientes desigualdades

      \begin{equation*}
        \begin{aligned}
          c < \log n \\
          c \log n < \log^2 n \\
          \log n^c < \log^2 n \\
          2^{\log n^c} < 2^{\log^2 n} \\
          n^c < 2^{\log^2 n} \\
          \frac{1}{2^{\log^2 n}} < \frac{1}{n^c}
        \end{aligned}
      \end{equation*}

    \subsection{Punto b)}
      \[f'(n) := f(n) + g(n)\]

      Sea $c>0$ y consideremos $f'(n) := f(n) + g(n)$. Por hipótesis, $f$ y $g$ son negligibles, es decir
      \[\lim_{n \to \infty} f(n)n^c = \lim_{n \to \infty} g(n)n^c =0\]
      Entonces 
      
      \begin{equation*}
        \begin{aligned}
          \lim_{n \to \infty} f'(n)n^c &= \lim_{n \to \infty} (f(n) + g(n))n^c \\
          &= \lim_{n \to \infty} f(n)n^c + \lim_{n \to \infty} g(n)n^c \\
          &= 0 + 0 = 0
        \end{aligned}
      \end{equation*}

      Por lo tanto, se concluye que $f'$ es una función negigible.

    \subsection{Punto c)}
      \[f'(n) := \frac{g(n)}{f(n)}\]
      
      Sea $f(n) = \frac{1}{2^n}$ y $g(n) = \frac{1}{2^{n+1}}$, con estas funciones se cumplen las 
      condiciones, es decir, $f(n) > g(n)$ y son negligibles (probado en clase), es decir, 
      \[\lim_{n \to \infty} f(n)n^c = \lim_{n \to \infty} g(n)n^c = 0 \text{ para todo } c\in \mathbb{N}\]

      Con esto en mente, vemos que 
      \[f'(n) = \frac{\frac{1}{2^{n+1}}}{\frac{1}{2^n}} = \frac{2^n}{2^{n+1}} = \frac{1}{2}\]

      y como $\lim_{n \to \infty} f'(n) \neq 0$, entonces $f'$ no es negligible, concluyendo así que el cociente bajo 
      esas condiciones no es necesariamente negligible.
\end{document}
